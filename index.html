<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ימי הולדת משפחת רלי רמות</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            margin: 0;
            padding: 16px;
            font-size: 16px;
        }
        h1 {
            color: #1976d2;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }
        .content-wrapper {
            max-width: 600px;
            margin: 0 auto;
        }
        #familyTable {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        #familyTable th, #familyTable td {
            border: 1px solid #ddd;
            padding: 10px 5px;
            text-align: right;
            font-size: 14px;
        }
        #familyTable th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .search-inputs, #idInput, #hebrewMonthSelect, #gregMonthSelect, #houseSelect, #upcomingSelect {
            padding: 12px;
            margin-bottom: 8px;
            margin-right: 12px;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        #searchInput {
            width: calc(100% - 24px);
        }
        #houseSelect, #idInput, #upcomingSelect {
            width: calc(100% - 24px);
        }
        .search-inputs {
            background-color: #e0f7fa;
            border: 1px solid #00796b;
        }
        .highlight {
            color: #d32f2f;
            font-weight: bold;
        }
        .highlight-date {
            color: #1976d2;
            font-weight: bold;
        }
        .search-label {
            display: block;
            margin-bottom: 4px;
            font-weight: bold;
        }
        .background-rali { background-color: #ffe6e6; }
        .background-a { background-color: #e6ffe6; }
        .background-b { background-color: #e6e6ff; }
        .background-c { background-color: #ffffe6; }
        #ageOutput {
            background-color: #fff3e0;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
        }
        .reset-btn, .upcoming-btn {
            width: 100%;
            padding: 12px;
            margin-bottom: 8px;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
        }
        .reset-btn {
            background-color: #f44336;
            color: #fff;
        }
        .upcoming-btn {
            background-color: #1976d2;
            color: #fff;
        }
        .id-link {
            color: #1976d2;
            text-decoration: underline;
            cursor: pointer;
        }
        #currentDate {
            margin-bottom: 8px;
            text-align: center;
            font-size: 14px;
        }
        .hebrew-birthday {
            color: #4caf50;
            font-weight: bold;
        }
        .greg-birthday {
            color: #f44336;
            font-weight: bold;
        }
        .search-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .upcoming-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            flex-wrap: wrap;
        }
        .upcoming-container label, .upcoming-container select, .upcoming-container button {
            margin-top: 8px;
        }
        .upcoming-container select {
            background-color: #1976d2;
            color: #fff;
            width: calc(60% - 12px); /* התאמת רוחב תיבת החיפוש */
        }
        .upcoming-container button {
            width: calc(40% - 12px); /* התאמת רוחב כפתור החיפוש */
        }
    </style>
</head>
<body>
    <div class="content-wrapper">
        <h1>משפחת רלי רמות</h1>
        <div id="currentDate"></div>
        
        <div>
            <label class="search-label" for="searchInput">חיפוש:</label>
            <input type="text" id="searchInput" class="search-inputs" placeholder="חפש שם, תאריך, חודש או בית אב...">
        </div>
        <div class="search-container">
            <div>
                <label class="search-label" for="houseSelect">חיפוש לפי בית אב:</label>
                <select id="houseSelect" class="search-inputs">
                    <option value="">בחר בית אב...</option>
                    <option value="רלי">רלי</option>
                    <option value="עידו">עידו</option>
                    <option value="תמר">תמר</option>
                    <option value="צאלה">צאלה</option>
                    <option value="אבידע">אבידע</option>
                    <option value="יוחאי">יוחאי</option>
                    <option value="אביתר">אביתר</option>
                </select>
            </div>
            <div>
                <label class="search-label" for="idInput">חיפוש מזהה:</label>
                <input type="number" id="idInput" class="search-inputs" placeholder="הכנס מספר מזהה לצפייה בגיל ופרטים נוספים...">
            </div>
        </div>
        
        <div class="search-container">
            <div style="width: calc(50% - 12px);">
                <label class="search-label" for="hebrewMonthSelect">יום הולדת לפי חודש עברי:</label>
                <select id="hebrewMonthSelect" class="search-inputs" style="width: 100%;">
                    <option value="">בחר חודש עברי...</option>
                    <option value="תשרי">תשרי</option>
                    <option value="חשוון">חשוון</option>
                    <option value="כסלו">כסלו</option>
                    <option value="טבת">טבת</option>
                    <option value="שבט">שבט</option>
                    <option value="אדר">אדר</option>
                    <option value="ניסן">ניסן</option>
                    <option value="אייר">אייר</option>
                    <option value="סיון">סיון</option>
                    <option value="תמוז">תמוז</option>
                    <option value="אב">אב</option>
                    <option value="אלול">אלול</option>
                </select>
            </div>
            <div style="width: calc(50% - 12px);">
                <label class="search-label" for="gregMonthSelect">יום הולדת לפי חודש לועזי:</label>
                <select id="gregMonthSelect" class="search-inputs" style="width: 100%;">
                    <option value="">בחר חודש לועזי...</option>
                    <option value="01">ינואר</option>
                    <option value="02">פברואר</option>
                    <option value="03">מרץ</option>
                    <option value="04">אפריל</option>
                    <option value="05">מאי</option>
                    <option value="06">יוני</option>
                    <option value="07">יולי</option>
                    <option value="08">אוגוסט</option>
                    <option value="09">ספטמבר</option>
                    <option value="10">אוקטובר</option>
                    <option value="11">נובמבר</option>
                    <option value="12">דצמבר</option>
                </select>
            </div>
        </div>
        
        <div class="upcoming-container">
            <div style="width: calc(60% - 12px);">
                <label class="search-label" for="upcomingSelect">הצג ימי הולדת קרובים:</label>
                <select id="upcomingSelect" class="search-inputs" style="width: 100%;">
                    <option value="today">היום</option>
                    <option value="7">7 ימים</option>
                    <option value="30">30 ימים</option>
                    <option value="60">60 ימים</option>
                    <option value="90">90 ימים</option>
                </select>
            </div>
            <div style="width: calc(40% - 12px);">
                <button class="upcoming-btn" onclick="showUpcomingBirthdays()" style="width: 100%;">להצגת ימי הולדת לחץ כאן</button>
            </div>
        </div>

        <button class="reset-btn" onclick="resetSearch()">נקה חיפוש</button>
        <p id="ageOutput"></p>

        <div style="overflow-x:auto;">
            <table id="familyTable">
                <thead>
                    <tr>
                        <th>מזהה</th>
                        <th>שם פרטי</th>
                        <th>שם משפחה</th>
                        <th>שם ההורים</th>
                        <th>תאריך לידה עברי</th>
                        <th>תאריך לידה לועזי</th>
                        <th>בית אב</th>
                    </tr>
                </thead>
                <tbody id="familyTableBody">
                    <!-- טבלת המשפחה תמולא באמצעות JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
    const familyData = [
        {id: 200, firstName: "<b>רלי</b>", lastName: "<b>רמות</b>", parents: "שמעון ושושנה", hebrewBirthDate: "ג' טבת תשי\"א", gregBirthDate: "12/12/1950", house: "רלי"},
        {id: 201, firstName: "<b>מלכה</b>", lastName: "<b>גוטמן</b>", parents: "דבורה וניסן", hebrewBirthDate: "", gregBirthDate: "", house: "רלי"},
        {id: 202, firstName: "<b>עדה</b>", lastName: "<b>רמות</b>", parents: "רות ודוד", hebrewBirthDate: "י\"ב אייר תשכ\"ו", gregBirthDate: "02/05/1966", house: "רלי"},
        {id: 203, firstName: "עידו", lastName: "רמות", parents: "רלי ועדה", hebrewBirthDate: "ט\"ז אב תשנ\"ד", gregBirthDate: "24/07/1994", house: "עידו"},
        {id: 204, firstName: "תמר", lastName: "רמות", parents: "רלי ועדה", hebrewBirthDate: "ט' חשון תשנ\"ט", gregBirthDate: "29/10/1998", house: "תמר"},
        {id: 205, firstName: "<b>צאלה</b>", lastName: "<b>רמות</b>", parents: "רלי ועדה", hebrewBirthDate: "ט' חשון תשנ\"ט", gregBirthDate: "29/10/1998", house: "צאלה"},
        {id: 206, firstName: "<b>הרן</b>", lastName: "<b>מלצר</b>", parents: "חן ויגאל", hebrewBirthDate: "י\"א אייר תשנ\"ד", gregBirthDate: "21/04/1994", house: "צאלה"},
        {id: 207, firstName: "<b>אבידע</b>", lastName: "<b>רמות</b>", parents: "רלי ומלכה", hebrewBirthDate: "י\"ד סיון תשל\"ד", gregBirthDate: "04/06/1974", house: "אבידע"},
        {id: 208, firstName: "<b>עינת</b>", lastName: "<b>רמות</b>", parents: "שרה וטוביה ז\"ז", hebrewBirthDate: "ד' תשרי תשל\"ו", gregBirthDate: "09/09/1975", house: "אבידע"},
        {id: 209, firstName: "גיל", lastName: "רמות", parents: "אבידע ועינת", hebrewBirthDate: "כ\"ג אדר תשס\"ז", gregBirthDate: "13/03/2007", house: "אבידע"},
        {id: 210, firstName: "רון", lastName: "רמות", parents: "אבידע ועינת", hebrewBirthDate: "ז' אדר תש\"ע", gregBirthDate: "21/02/2010", house: "אבידע"},
        {id: 211, firstName: "אור", lastName: "רמות", parents: "אבידע ועינת", hebrewBirthDate: "כ\"ה אב תשע\"ז", gregBirthDate: "17/08/2017", house: "אבידע"},
        {id: 212, firstName: "<b>יוחאי</b>", lastName: "<b>רמות</b>", parents: "רלי ומלכה", hebrewBirthDate: "ט\"ז ניסן תשל\"ח", gregBirthDate: "23/04/1978", house: "יוחאי"},
        {id: 213, firstName: "<b>שמרית</b>", lastName: "<b>רמות</b>", parents: "גאולה ואריק", hebrewBirthDate: "ב' ניסן תשל\"ט", gregBirthDate: "30/03/1979", house: "יוחאי"},
        {id: 214, firstName: "איתן", lastName: "רמות", parents: "יוחאי ושמרית", hebrewBirthDate: "ל' שבט תשע\"ב", gregBirthDate: "23/02/2012", house: "יוחאי"},
        {id: 215, firstName: "יעלה", lastName: "רמות", parents: "יוחאי ושמרית", hebrewBirthDate: "ט\"ז תשרי תשע\"ה", gregBirthDate: "10/10/2014", house: "יוחאי"},
        {id: 216, firstName: "<b>אביתר</b>", lastName: "<b>רמות</b>", parents: "רלי ומלכה", hebrewBirthDate: "ב' תשרי תשמ\"ח", gregBirthDate: "25/09/1987", house: "אביתר"},
        {id: 217, firstName: "<b>שיר</b>", lastName: "<b>רמות</b>", parents: "גילה וירון", hebrewBirthDate: "ח' אדר תשמ\"ז", gregBirthDate: "09/03/1987", house: "אביתר"},
        {id: 218, firstName: "יובל", lastName: "רמות", parents: "אביתר ושיר", hebrewBirthDate: "ה' טבת תשע\"ח", gregBirthDate: "23/12/2017", house: "אביתר"},
        {id: 219, firstName: "דרור", lastName: "רמות", parents: "אביתר ושיר", hebrewBirthDate: "י' ניסן תש\"פ", gregBirthDate: "04/04/2020", house: "אביתר"}
    ];

    function populateTable() {
        const tableBody = document.getElementById('familyTableBody');
        familyData.forEach(person => {
            const row = tableBody.insertRow();
            row.className = `background-${person.house.toLowerCase().replace(" ", "_")}`;
            row.innerHTML = `
                <td><a class="id-link" onclick="showDetails(${person.id})">${person.id}</a></td>
                <td>${person.firstName}</td>
                <td>${person.lastName}</td>
                <td>${person.parents}</td>
                <td>${person.hebrewBirthDate}</td>
                <td>${person.gregBirthDate}</td>
                <td>${person.house}</td>
            `;
        });
    }

    function searchTable() {
        const input = document.getElementById("searchInput").value.toUpperCase();
        const hebrewMonth = document.getElementById("hebrewMonthSelect").value;
        const gregMonth = document.getElementById("gregMonthSelect").value;
        const house = document.getElementById("houseSelect").value;
        const table = document.getElementById("familyTable");
        const tr = table.getElementsByTagName("tr");

        for (let i = 1; i < tr.length; i++) {
            let td = tr[i].getElementsByTagName("td");
            let found = false;
            let txtValue = "";
            for (let j = 0; j < td.length; j++) {
                if (td[j]) {
                    txtValue = td[j].textContent || td[j].innerText;
                    if (txtValue.toUpperCase().indexOf(input) > -1) {
                        found = true;
                        break;
                    }
                }
            }

            if (hebrewMonth && !td[4].textContent.includes(hebrewMonth)) {
                found = false;
            }

            if (gregMonth && !td[5].textContent.includes(`/${gregMonth}/`)) {
                found = false;
            }

            if (house && !td[6].textContent.includes(house)) {
                found = false;
            }

            tr[i].style.display = found ? "" : "none";
        }
    }

    function resetSearch() {
        document.getElementById('searchInput').value = '';
        document.getElementById('hebrewMonthSelect').value = '';
        document.getElementById('gregMonthSelect').value = '';
        document.getElementById('houseSelect').value = '';
        document.getElementById('upcomingSelect').value = '7';
        document.getElementById('idInput').value = '';
        document.getElementById('ageOutput').innerHTML = '';
        searchTable();
    }

    function calculateAge() {
        const idValue = document.getElementById("idInput").value;
        const ageOutput = document.getElementById("ageOutput");
        showDetails(idValue);
    }

    function showDetails(idValue) {
        const ageOutput = document.getElementById("ageOutput");
        const person = familyData.find(p => p.id == idValue);
        
        if (person) {
            const birthDate = new Date(person.gregBirthDate.split("/").reverse().join("-"));
            const today = new Date();
            let age = today.getFullYear() - birthDate.getFullYear();
            const m = today.getMonth() - birthDate.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }

            const nextBirthday = new Date(today.getFullYear(), birthDate.getMonth(), birthDate.getDate());
            if (today > nextBirthday) {
                nextBirthday.setFullYear(today.getFullYear() + 1);
            }
            const daysToNextBirthday = Math.ceil((nextBirthday - today) / (1000 * 60 * 60 * 24));
            const nextBirthdayStr = nextBirthday.toLocaleDateString('he-IL');

            const daysOfWeek = ['ראשון', 'שני', 'שלישי', 'רביעי', 'חמישי', 'שישי', 'שבת'];
            const dayOfWeekHeb = daysOfWeek[nextBirthday.getDay()];

            ageOutput.innerHTML = `
                מזהה ${idValue}:<br>
                ${person.firstName} ${person.lastName}<br>
                ההורים: <b>${person.parents}</b><br>
                גיל: <span class="highlight">${age}</span><br>
                תאריך לידה עברי: <span class="highlight-date">${person.hebrewBirthDate}</span><br>
                תאריך לידה לועזי: <span class="highlight-date">${person.gregBirthDate}</span><br>
                יום הולדת הבא בעוד <span class="highlight">${daysToNextBirthday} ימים</span><br>
                בתאריך: <span class="highlight-date">${nextBirthdayStr} (${dayOfWeekHeb})</span><br>
                גיל ביום ההולדת הקרוב: <span class="highlight">${age + 1}</span>
            `;
        } else {
            ageOutput.innerHTML = "לא נמצא אדם עם מזהה זה";
        }
    }

    function updateCurrentDate() {
        const now = new Date();
        const hebrewDate = new Intl.DateTimeFormat('he-IL-u-ca-hebrew', {
            weekday: 'long',
            day: 'numeric',
            month: 'long',
            year: 'numeric'
        }).format(now);
        const gregorianDate = new Intl.DateTimeFormat('he-IL', {
            weekday: 'long',
            day: 'numeric',
            month: 'long',
            year: 'numeric'
        }).format(now);
        document.getElementById('currentDate').innerHTML = `בס"ד<br>היום: ${hebrewDate}<br>תאריך לועזי: ${gregorianDate}`;
    }

    function showUpcomingBirthdays() {
        const today = new Date();
        const daysToShow = parseInt(document.getElementById('upcomingSelect').value);

        const upcomingBirthdays = familyData.filter(person => {
            const gregBirthDate = new Date(person.gregBirthDate.split("/").reverse().join("-"));
            const nextBirthday = new Date(today.getFullYear(), gregBirthDate.getMonth(), gregBirthDate.getDate());
            if (today > nextBirthday) {
                nextBirthday.setFullYear(today.getFullYear() + 1);
            }
            const daysToNextBirthday = Math.ceil((nextBirthday - today) / (1000 * 60 * 60 * 24));

            return daysToNextBirthday <= daysToShow;
        });

        const sortedBirthdays = upcomingBirthdays.sort((a, b) => {
            const aDate = new Date(a.gregBirthDate.split("/").reverse().join("-"));
            const bDate = new Date(b.gregBirthDate.split("/").reverse().join("-"));
            return aDate - bDate;
        });

        const ageOutput = document.getElementById("ageOutput");
        ageOutput.innerHTML = `<b>ימי הולדת קרובים ב-${daysToShow} הימים הקרובים:</b><br>`;

        if (sortedBirthdays.length === 0) {
            ageOutput.innerHTML += "אין ימי הולדת במשפחה.";
        } else {
            sortedBirthdays.forEach(person => {
                const birthDate = new Date(person.gregBirthDate.split("/").reverse().join("-"));
                const today = new Date();
                let age = today.getFullYear() - birthDate.getFullYear();
                const m = today.getMonth() - birthDate.getMonth();
                if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }

                const nextGregorianBirthday = new Date(today.getFullYear(), birthDate.getMonth(), birthDate.getDate());
                if (today > nextGregorianBirthday) {
                    nextGregorianBirthday.setFullYear(today.getFullYear() + 1);
                }
                const daysToNextGregorianBirthday = Math.ceil((nextGregorianBirthday - today) / (1000 * 60 * 60 * 24));

                ageOutput.innerHTML += `
                    <div class="${person.house.toLowerCase().replace(" ", "_")}">
                        <b>${person.firstName} ${person.lastName}</b> - תאריך לועזי: <span class="greg-birthday">${person.gregBirthDate}</span>, 
                        תאריך עברי: <span class="hebrew-birthday">${person.hebrewBirthDate}</span><br>
                        גיל ביום ההולדת הקרוב: ${age + 1},<br>
                        ימים ליום הולדת לועזי: ${daysToNextGregorianBirthday}
                    </div>`;
            });
        }
    }

    document.addEventListener('DOMContentLoaded', function() {
        populateTable();
        updateCurrentDate();
        document.getElementById('searchInput').addEventListener('keyup', searchTable);
        document.getElementById('hebrewMonthSelect').addEventListener('change', searchTable);
        document.getElementById('gregMonthSelect').addEventListener('change', searchTable);
        document.getElementById('houseSelect').addEventListener('change', searchTable);
        document.getElementById('idInput').addEventListener('input', calculateAge);
    });

    setInterval(updateCurrentDate, 86400000); // עדכון יומי
    </script>
</body>
</html>
